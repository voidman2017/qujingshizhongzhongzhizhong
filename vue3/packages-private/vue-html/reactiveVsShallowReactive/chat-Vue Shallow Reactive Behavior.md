### USER
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./vue.global.js"></script>
  </head>
  <body>
    <div id="app">
      <button @click="changeShallowReactiveProperty">
        changeShallowReactiveProperty
      </button>
      <ul style="color: blue">
        <li v-for="item in shallowReactiveObj">{{ item.obj.depth }}</li>
      </ul>
    </div>
    <div id="app2">
      <button @click="changeReactiveProperty">changeReactiveProperty</button>
      <ul style="color: red">
        <li v-for="item in reactiveObj">{{ item.obj.depth }}</li>
      </ul>
    </div>
    <script>
      const { createApp, reactive, shallowReactive } = Vue
      const n = 10
      const obj = Array(n)
        .fill()
        .map((_, i) => ({
          id: i,
          depth: `${i}-1`, // â† è¿™æ˜¯ç¬¬1å±‚åµŒå¥—å¯¹è±¡
          obj: {
            depth: `${i}-2`, // â† è¿™æ˜¯ç¬¬2å±‚åµŒå¥—å¯¹è±¡
            obj: {
              depth: `${i}-3`, // â† è¿™æ˜¯ç¬¬3å±‚åµŒå¥—å¯¹è±¡
              obj: {
                depth: `${i}-4`, // â† è¿™æ˜¯ç¬¬4å±‚åµŒå¥—å¯¹è±¡
              },
            },
          },
        }))
      const shallowReactiveObj = shallowReactive(obj)
      const changeShallowReactiveProperty = () => {
        shallowReactiveObj[0].obj.depth += '!'
      }
      createApp({
        setup() {
          return {
            changeShallowReactiveProperty,
            shallowReactiveObj,
          }
        },
      }).mount('#app')

      const obj2 = Array(n)
        .fill()
        .map((_, i) => ({
          id: i,
          depth: `${i}-1`, // â† è¿™æ˜¯ç¬¬1å±‚åµŒå¥—å¯¹è±¡
          obj: {
            depth: `${i}-2`, // â† è¿™æ˜¯ç¬¬2å±‚åµŒå¥—å¯¹è±¡
            obj: {
              depth: `${i}-3`, // â† è¿™æ˜¯ç¬¬3å±‚åµŒå¥—å¯¹è±¡
              obj: {
                depth: `${i}-4`, // â† è¿™æ˜¯ç¬¬4å±‚åµŒå¥—å¯¹è±¡
              },
            },
          },
        }))
      const reactiveObj = reactive(obj2)
      const changeReactiveProperty = () => {
        reactiveObj[0].obj.depth += '!'
      }
      createApp({
        setup() {
          return {
            changeReactiveProperty,
            reactiveObj,
          }
        },
      }).mount('#app2')
    </script>
  </body>
</html>
è¿™é‡Œç‚¹å‡»changeShallowReactivePropertyï¼Œè§†å›¾ä¸ä¼šæ›´æ–°

### ASSISTANT
ä½ æå‡ºçš„é—®é¢˜éå¸¸å…¸å‹ï¼Œæ¶‰åŠåˆ° Vue 3 ä¸­ `shallowReactive` çš„è¡Œä¸ºæœºåˆ¶ã€‚

---

### âœ… **é—®é¢˜æ€»ç»“ï¼š**
ä½ ä½¿ç”¨äº† `shallowReactive` åˆ›å»ºå“åº”å¼å¯¹è±¡ï¼Œå¹¶åœ¨ç‚¹å‡»æŒ‰é’®æ—¶ä¿®æ”¹äº†åµŒå¥—è¾ƒæ·±çš„å±æ€§ï¼š

```js
shallowReactiveObj[0].obj.depth += '!'
```

ä½†é¡µé¢**æ²¡æœ‰æ›´æ–°**ã€‚è€Œä½¿ç”¨ `reactive` çš„ç‰ˆæœ¬å´èƒ½æ­£å¸¸æ›´æ–°ã€‚

---

### â“ **åŸå› åˆ†æï¼š**

#### ğŸ”¹ `shallowReactive` æ˜¯â€œæµ…å±‚â€å“åº”å¼çš„

Vue 3 æä¾›çš„ `shallowReactive` åªä¼šå°†å¯¹è±¡çš„**ç¬¬ä¸€å±‚å±æ€§**å˜æˆå“åº”å¼ï¼Œ**ä¸ä¼šé€’å½’å¤„ç†æ·±å±‚åµŒå¥—å¯¹è±¡**ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼š

```js
const shallowReactiveObj = shallowReactive([
  {
    id: 0,
    depth: "0-1",
    obj: {        // â† è¿™ä¸ª obj å¯¹è±¡æœ¬èº«ä¸æ˜¯ reactive çš„ï¼
      depth: "0-2",
      obj: { ... }
    }
  }
])
```

- `shallowReactiveObj[0]` æ˜¯å“åº”å¼çš„ï¼ˆç¬¬ä¸€å±‚ï¼‰
- ä½†æ˜¯ `shallowReactiveObj[0].obj` æ˜¯**åŸå§‹å¯¹è±¡**ï¼Œä¸æ˜¯å“åº”å¼çš„
- æ‰€ä»¥å½“ä½ åšï¼š
  ```js
  shallowReactiveObj[0].obj.depth += '!'
  ```
  è™½ç„¶å€¼å˜äº†ï¼Œä½† Vue **æ— æ³•è¿½è¸ªåˆ°è¿™ä¸ªå˜åŒ–**ï¼Œå› ä¸º `.obj` ä¸æ˜¯å“åº”å¼ä»£ç†ã€‚

> ğŸš« å› æ­¤ï¼Œ**è§†å›¾ä¸ä¼šæ›´æ–°**ã€‚

---

#### âœ… ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`reactive` æ˜¯æ·±åº¦å“åº”å¼çš„

```js
const reactiveObj = reactive([...])
```

- `reactive` ä¼šé€’å½’åœ°æŠŠæ‰€æœ‰åµŒå¥—å¯¹è±¡éƒ½è½¬æˆå“åº”å¼ï¼ˆé€šè¿‡ `Proxy` é€å±‚ä»£ç†ï¼‰
- æ‰€ä»¥ `reactiveObj[0].obj` ä¹Ÿæ˜¯ä¸€ä¸ªå“åº”å¼å¯¹è±¡
- ä¿®æ”¹å®ƒçš„ `.depth` å±æ€§æ—¶ï¼ŒVue èƒ½æ£€æµ‹åˆ°å˜åŒ–
- âœ… è§†å›¾æˆåŠŸæ›´æ–°

---

### ğŸ§ª éªŒè¯æ–¹å¼

ä½ å¯ä»¥åŠ ä¸ªè°ƒè¯•è¯­å¥éªŒè¯ï¼š

```js
console.log(shallowReactiveObj[0].obj === obj[0].obj) // true
console.log(reactiveObj[0].obj === obj2[0].obj)       // false
```

- `shallowReactive` ä¸ä¼šæ›¿æ¢åµŒå¥—å¯¹è±¡ â†’ å¼•ç”¨ç›¸åŒ â†’ éå“åº”å¼
- `reactive` ä¼šé€’å½’åˆ›å»ºä»£ç† â†’ å¼•ç”¨ä¸åŒ â†’ æ·±å±‚å“åº”å¼

---

### âœ… å¦‚ä½•ä¿®å¤ï¼Ÿæˆ–è€…å¦‚ä½•æ­£ç¡®ä½¿ç”¨ `shallowReactive`ï¼Ÿ

#### âœ”ï¸ æ–¹æ³•ä¸€ï¼šé¿å…ä¿®æ”¹æ·±å±‚å±æ€§ï¼ˆ`shallowReactive` çš„é€‚ç”¨åœºæ™¯ï¼‰

`shallowReactive` é€‚åˆç”¨äºæ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼Œæ¯”å¦‚å¤§å‹åˆ—è¡¨ï¼Œä½ åªå¸Œæœ›ç¬¬ä¸€å±‚æ˜¯å“åº”å¼çš„ï¼Œå†…éƒ¨ç»“æ„ç¨³å®šæˆ–æ‰‹åŠ¨æ§åˆ¶æ›´æ–°ã€‚

å¦‚æœä½ éè¦æ”¹æ·±å±‚æ•°æ®å¹¶è§¦å‘æ›´æ–°ï¼Œåº”è¯¥**æ›¿æ¢æ•´ä¸ªç¬¬ä¸€å±‚é¡¹**ï¼š

```js
const changeShallowReactiveProperty = () => {
  const item = shallowReactiveObj[0]
  // åˆ›å»ºæ–°å¯¹è±¡æ¥è§¦å‘å“åº”å¼æ›´æ–°
  shallowReactiveObj[0] = {
    ...item,
    obj: {
      ...item.obj,
      depth: item.obj.depth + '!',
    },
  }
}
```

è¿™æ ·å› ä¸ºæ›¿æ¢äº† `shallowReactiveObj[0]`ï¼ˆç¬¬ä¸€å±‚ï¼‰ï¼Œè€Œå®ƒæ˜¯å“åº”å¼çš„ï¼Œæ‰€ä»¥è§†å›¾ä¼šæ›´æ–°ã€‚

---

#### âœ”ï¸ æ–¹æ³•äºŒï¼šæ”¹ç”¨ `reactive`ï¼ˆæ¨èå¤§å¤šæ•°æƒ…å†µï¼‰

é™¤éä½ æœ‰æ€§èƒ½ä¼˜åŒ–éœ€æ±‚ï¼ˆå¦‚ä¸Šåƒä¸ªå¯¹è±¡ã€é¢‘ç¹æ›´æ–°ï¼‰ï¼Œå¦åˆ™ç›´æ¥ç”¨ `reactive` æ›´ç›´è§‚å®‰å…¨ã€‚

---

### ğŸ’¡ æ€»ç»“

| æ“ä½œ | æ˜¯å¦è§¦å‘è§†å›¾æ›´æ–° | åŸå›  |
|------|------------------|------|
| `shallowReactiveObj[0].obj.depth += '!'` | âŒ å¦ | `.obj` ä¸æ˜¯å“åº”å¼å¯¹è±¡ |
| `reactiveObj[0].obj.depth += '!'` | âœ… æ˜¯ | æ‰€æœ‰å±‚çº§éƒ½æ˜¯å“åº”å¼ |
| `shallowReactiveObj[0] = newValue` | âœ… æ˜¯ | ç¬¬ä¸€å±‚æ˜¯å“åº”å¼ï¼Œèµ‹å€¼å¯è¢«ç›‘å¬ |

---

### âœ… æœ€ä½³å®è·µå»ºè®®

- ä½¿ç”¨ `shallowReactive` æ—¶ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹æ·±å±‚å±æ€§ã€‚
- è‹¥éœ€ä¿®æ”¹æ·±å±‚æ•°æ®ï¼Œè¯·é€šè¿‡**æ›¿æ¢ç¬¬ä¸€å±‚å…ƒç´ **çš„æ–¹å¼è§¦å‘æ›´æ–°ã€‚
- å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œç›´æ¥ä½¿ç”¨ `reactive` æˆ– `ref` æ›´ç®€å•å¯é ã€‚
- `shallowReactive` é€‚ç”¨äºæ€§èƒ½ä¼˜åŒ–åœºæ™¯ï¼ˆå¦‚è™šæ‹Ÿæ»šåŠ¨é•¿åˆ—è¡¨ï¼‰ã€‚

---

âœ… **ç»“è®ºï¼šä½ çš„ä»£ç è¡Œä¸ºç¬¦åˆé¢„æœŸï¼Œä¸æ˜¯ bugï¼Œè€Œæ˜¯ `shallowReactive` çš„è®¾è®¡ç‰¹æ€§ã€‚**

### USER
å¦‚æœè¿™é‡Œå°±æ˜¯è¦ä¿®æ”¹æ·±å±‚å±æ€§ï¼Œè¯¥æ€ä¹ˆåŠ

### ASSISTANT
å¦‚æœä½ **æ˜ç¡®éœ€è¦ä¿®æ”¹æ·±å±‚å±æ€§**ï¼Œå¹¶ä¸”å¸Œæœ›è§†å›¾èƒ½å“åº”å¼æ›´æ–°ï¼Œé‚£ä¹ˆæ ¹æ®ä½ å½“å‰ä½¿ç”¨çš„æ˜¯ `shallowReactive` è¿˜æ˜¯æƒ³ä¿æŒæ€§èƒ½ä¼˜åŒ–ç›®æ ‡ï¼Œæœ‰ä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆï¼š

---

## âœ… **æ–¹æ¡ˆä¸€ï¼šæ”¹ç”¨ `reactive`ï¼ˆæœ€ç®€å•ã€æ¨èï¼‰**

å¦‚æœä½ è¦é¢‘ç¹æ“ä½œæ·±å±‚åµŒå¥—å¯¹è±¡å¹¶æœŸæœ›å“åº”å¼æ›´æ–°ï¼Œ**ç›´æ¥ä½¿ç”¨ `reactive` å°±æ˜¯æœ€è‡ªç„¶çš„é€‰æ‹©ã€‚**

```js
const reactiveObj = reactive(obj2) // æ·±å±‚å“åº”å¼
```

âœ… ä¼˜ç‚¹ï¼š
- æ‰€æœ‰å±‚çº§è‡ªåŠ¨å˜æˆå“åº”å¼
- ä¿®æ”¹ä»»æ„æ·±å±‚å±æ€§éƒ½ä¼šè§¦å‘æ›´æ–°

âŒ ç¼ºç‚¹ï¼š
- å¯¹è¶…å¤§å¯¹è±¡æˆ–æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¼šæœ‰ä¸€å®šå¼€é”€ï¼ˆé€’å½’ä»£ç†ï¼‰

ğŸ‘‰ **é€‚ç”¨äºå¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ï¼Œæ¨èä¼˜å…ˆä½¿ç”¨ã€‚**

---

## âœ… **æ–¹æ¡ˆäºŒï¼šä¿ç•™ `shallowReactive`ï¼Œä½†é€šè¿‡æ›¿æ¢ç¬¬ä¸€å±‚æ¥â€œé—´æ¥â€æ›´æ–°**

å¦‚æœä½ æƒ³ç»§ç»­ä½¿ç”¨ `shallowReactive`ï¼ˆæ¯”å¦‚å‡ºäºæ€§èƒ½è€ƒè™‘ï¼‰ï¼Œå°±ä¸èƒ½ç›´æ¥æ”¹æ·±å±‚å±æ€§ï¼Œè€Œåº”è¯¥**æ›¿æ¢æ•´ä¸ªç¬¬ä¸€å±‚å¯¹è±¡**æ¥è§¦å‘å“åº”å¼ã€‚

### ğŸ”§ ä¿®æ”¹ä½ çš„å‡½æ•°å¦‚ä¸‹ï¼š

```js
const changeShallowReactiveProperty = () => {
  const item = shallowReactiveObj[0]
  shallowReactiveObj[0] = {
    ...item,
    obj: {
      ...item.obj,
      depth: item.obj.depth + '!',
    },
  }
}
```

> ğŸ’¡ æ³¨æ„ï¼šæˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä¿®æ”¹ `obj.depth`ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡èµ‹å€¼å›å»ï¼Œè¿™æ · Vue èƒ½æ£€æµ‹åˆ°ç¬¬ä¸€å±‚çš„å˜åŒ–ã€‚

âœ… ä¼˜ç‚¹ï¼š
- ä»å¯ä½¿ç”¨ `shallowReactive` æé«˜æ€§èƒ½
- è§†å›¾èƒ½æ­£å¸¸æ›´æ–°

âš ï¸ æ³¨æ„ï¼š
- å¦‚æœåµŒå¥—æ›´æ·±ï¼ˆå¦‚ `.obj.obj.depth`ï¼‰ï¼Œä½ ä¹Ÿéœ€è¦é€å±‚å±•å¼€ç»“æ„ï¼Œé¿å…å¼•ç”¨æ—§å¯¹è±¡ã€‚

#### ğŸ“¦ æ›´æ·±å±‚çš„å†™æ³•ç¤ºä¾‹ï¼ˆä¿®æ”¹ç¬¬4å±‚ï¼‰ï¼š

```js
shallowReactiveObj[0] = {
  ...shallowReactiveObj[0],
  obj: {
    ...shallowReactiveObj[0].obj,
    obj: {
      ...shallowReactiveObj[0].obj.obj,
      obj: {
        ...shallowReactiveObj[0].obj.obj.obj,
        depth: shallowReactiveObj[0].obj.obj.obj.depth + '!',
      },
    },
  },
}
```

è™½ç„¶ç•¥å•°å—¦ï¼Œä½†è¿™æ˜¯å®‰å…¨çš„æ–¹å¼ã€‚

---

## âœ… **æ–¹æ¡ˆä¸‰ï¼šæŠŠæ·±å±‚å¯¹è±¡ä¹Ÿæ‰‹åŠ¨è½¬ä¸º `reactive`**

ä½ å¯ä»¥å¯¹å…³é”®çš„æ·±å±‚å­—æ®µ**å•ç‹¬åšå“åº”å¼å¤„ç†**ï¼Œç»“åˆæµ…å±‚ä¸æ·±å±‚å“åº”å¼ã€‚

```js
const obj = Array(n)
  .fill()
  .map((_, i) => ({
    id: i,
    depth: `${i}-1`,
    obj: reactive({  // ğŸ‘ˆ æ‰‹åŠ¨å°† inner obj è®¾ä¸º reactive
      depth: `${i}-2`,
      obj: {
        depth: `${i}-3`,
        obj: {
          depth: `${i}-4`,
        },
      },
    }),
  }))

const shallowReactiveObj = shallowReactive(obj)
```

ç„¶ååœ¨æ–¹æ³•ä¸­ä¿®æ”¹ï¼š

```js
const changeShallowReactiveProperty = () => {
  shallowReactiveObj[0].obj.depth += '!' // âœ… ç°åœ¨å¯ä»¥è§¦å‘æ›´æ–°ï¼
}
```

å› ä¸º `.obj` æ˜¯ `reactive` çš„ï¼Œæ‰€ä»¥å®ƒçš„å˜åŒ–ä¹Ÿèƒ½è¢«è¿½è¸ªã€‚

âœ… ä¼˜ç‚¹ï¼š
- çµæ´»æ§åˆ¶å“ªäº›å­å¯¹è±¡éœ€è¦æ·±åº¦å“åº”å¼
- æ€§èƒ½å’Œå“åº”æ€§å¹³è¡¡è¾ƒå¥½

---

## âœ… **æ–¹æ¡ˆå››ï¼šä½¿ç”¨ `ref` åŒ…è£¹å¤æ‚ç»“æ„ï¼ˆå¦ä¸€ç§æ€è·¯ï¼‰**

`ref` åœ¨ setup ä¸­ä¼šè‡ªåŠ¨ deep-reactiveï¼Œå³ä½¿åŒ…è£¹çš„æ˜¯æ·±å±‚å¯¹è±¡ã€‚

```js
import { ref, shallowReactive } from 'vue'

// ä½¿ç”¨ ref æ¥ç®¡ç†è¿™ä¸ªæ•°ç»„
const shallowReactiveObj = ref(
  Array(n)
    .fill()
    .map((_, i) => ({ ... })) // åŸå§‹æ•°æ®ç»“æ„
)
```

æ¨¡æ¿ä¸­è®¿é—®ï¼š

```html
<li v-for="item in shallowReactiveObj">{{ item.obj.depth }}</li>
```

JS ä¸­ä¿®æ”¹ï¼š

```js
const changeShallowReactiveProperty = () => {
  shallowReactiveObj.value[0].obj.depth += '!' // âœ… å¯ä»¥è§¦å‘æ›´æ–°
}
```

å› ä¸º `ref` å†…éƒ¨ç”¨äº† `reactive` åšæ·±å±‚è½¬æ¢ï¼ˆå¦‚æœæ˜¯å¯¹è±¡çš„è¯ï¼‰ï¼Œæ‰€ä»¥ä¾ç„¶å…·å¤‡æ·±å±‚å“åº”æ€§ã€‚

---

## ğŸ æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ

| éœ€æ±‚ | æ¨èæ–¹æ¡ˆ |
|------|----------|
| âœ… æƒ³è‡ªç”±ä¿®æ”¹ä»»æ„æ·±å±‚å±æ€§ï¼Œä¸”ä¸æ‹…å¿ƒæ€§èƒ½ | â¡ï¸ ä½¿ç”¨ `reactive` |
| âš ï¸ å¤§å‹åˆ—è¡¨ï¼Œåªå¶å°”æ›´æ–°æ·±å±‚æ•°æ® | â¡ï¸ `shallowReactive` + æ›¿æ¢ç¬¬ä¸€å±‚å¯¹è±¡ |
| ğŸ”§ æƒ³ç²¾ç»†æ§åˆ¶éƒ¨åˆ†å­å¯¹è±¡å“åº”å¼ | â¡ï¸ `shallowReactive` + å¯¹ç‰¹å®šå­—æ®µç”¨ `reactive` åŒ…è£¹ |
| ğŸ”„ æ›´çµæ´»çš„æ•°æ®ç»“æ„ç®¡ç† | â¡ï¸ ä½¿ç”¨ `ref`ï¼ˆè‡ªåŠ¨æ·±å±‚å“åº”å¼ï¼‰ |

---

### âœ… æ¨èæœ€ç»ˆåšæ³•ï¼ˆç®€æ´å¯é ï¼‰ï¼š

```js
const reactiveObj = reactive(obj) // ç›´æ¥ä¸Š reactiveï¼Œçœäº‹åˆç¨³å®š
```

é™¤éä½ çœŸçš„é‡åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œå¦åˆ™ä¸è¦è¿‡æ—©ä¼˜åŒ– `shallowReactive`ã€‚

> ğŸ’¬ æ­£å¦‚ Vue å®˜æ–¹æ‰€è¯´ï¼š**â€œUse the right tool for the job.â€**  
> `shallowReactive` æ˜¯æ€§èƒ½ä¼˜åŒ–å·¥å…·ï¼Œä¸æ˜¯é»˜è®¤é€‰é¡¹ã€‚

--- 

å¦‚æœ‰æ›´å¤šä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚æ•°æ®é‡æœ‰å¤šå¤§ï¼Ÿæ›´æ–°é¢‘ç‡ï¼Ÿï¼‰ï¼Œæˆ‘å¯ä»¥å¸®ä½ è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯å¦å€¼å¾—ç”¨ `shallowReactive`ã€‚

### USER
ä½¿ç”¨shallowRef + triggetRefå¯ä»¥ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆæ²¡æœ‰ç±»ä¼¼ triggetReactiveçš„æ–¹æ³•

### ASSISTANT
è¿™æ˜¯ä¸€ä¸ªéå¸¸æ·±å…¥ä¸”é«˜è´¨é‡çš„é—®é¢˜ï¼

ä½ æåˆ°ï¼š

> â€œä½¿ç”¨ `shallowRef` + `triggerRef` å¯ä»¥æ‰‹åŠ¨è§¦å‘æ›´æ–°ï¼Œé‚£ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»ä¼¼çš„ `triggerReactive` æ–¹æ³•ï¼Ÿâ€

è¿™ä¸ªé—®é¢˜è§¦åŠäº† Vue 3 å“åº”å¼ç³»ç»Ÿè®¾è®¡çš„æ ¸å¿ƒæ€æƒ³ â€”â€” **`ref` å’Œ `reactive` çš„å®šä½å·®å¼‚**ã€‚

---

## âœ… ç®€çŸ­å›ç­”ï¼š

> âŒ æ²¡æœ‰ `triggerReactive` æ˜¯å› ä¸ºï¼š
>
> - `reactive` å·²ç»æ˜¯**æ·±å±‚è‡ªåŠ¨å“åº”å¼**çš„ï¼Œä¸éœ€è¦æ‰‹åŠ¨â€œè§¦å‘â€ã€‚
> - è€Œ `shallowRef` æ˜¯ä¸€ä¸ª**ç‰¹ä¾‹**ï¼šå®ƒå…è®¸ä½ æ§åˆ¶ä½•æ—¶é€šçŸ¥ Vue â€œè¿™ä¸ªå¯¹è±¡å˜äº†â€ï¼Œæ‰€ä»¥éœ€è¦ `triggerRef` æ¥é…åˆã€‚
> - è®¾è®¡ä¸Šï¼Œ`reactive` çš„å“²å­¦æ˜¯â€œå…¨è‡ªåŠ¨â€ï¼Œè€Œ `ref`ï¼ˆå°¤å…¶æ˜¯ `shallowRef`ï¼‰æä¾›äº†â€œæ‰‹åŠ¨å¹²é¢„â€çš„èƒ½åŠ›ã€‚

---

## ğŸ§± è¯¦ç»†è§£é‡Š

### ğŸ”¹ 1. `ref` vs `reactive` çš„æœ¬è´¨åŒºåˆ«

| ç‰¹æ€§ | `ref` | `reactive` |
|------|------|------------|
| å†…éƒ¨å®ç° | `RefImpl` å¯¹è±¡ï¼ˆå¸¦ `.value`ï¼‰ | `Proxy` ä»£ç†åŸå¯¹è±¡ |
| æ˜¯å¦ä¿ç•™åŸå§‹å¼•ç”¨ | å¦ï¼ˆ`.value` åŒ…è£…ï¼‰ | æ˜¯ï¼ˆè¿”å›ä»£ç†å¯¹è±¡ï¼‰ |
| æ˜¯å¦å¯æ›¿æ¢æ•´ä¸ªå€¼ | âœ… æ˜¯ï¼ˆ`count.value = newCount`ï¼‰ | âŒ å¦ï¼ˆä¸èƒ½é‡æ–°èµ‹å€¼ä»£ç†å¯¹è±¡æœ¬èº«ï¼‰ |
| æ˜¯å¦æ”¯æŒæ‰‹åŠ¨è§¦å‘æ›´æ–° | âœ… `triggerRef()` é…åˆ `shallowRef` | âŒ ä¸éœ€è¦ |

---

### ğŸ”¹ 2. ä¸ºä»€ä¹ˆä¼šæœ‰ `triggerRef`ï¼Ÿ

#### ğŸ’¡ åœºæ™¯ï¼š`shallowRef`

```js
const state = shallowRef({
  hugeList: [...], // å¾ˆå¤§çš„æ•°ç»„æˆ–å¤æ‚ç»“æ„
  timestamp: Date.now()
})
```

- æ­¤æ—¶ `.value` æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå®ƒçš„å±æ€§**ä¸ä¼šè¢«é€’å½’è½¬ä¸ºå“åº”å¼**
- å¦‚æœä½ ç›´æ¥æ”¹ï¼š
  ```js
  state.value.hugeList.push(newItem) // âŒ ä¸ä¼šè§¦å‘æ›´æ–°
  ```
- ä½†ä½ å¯ä»¥è¿™æ ·å‘Šè¯‰ Vueï¼šâ€œæˆ‘æ”¹äº†ï¼Œè¯·æ›´æ–°â€ï¼š
  ```js
  state.value.hugeList.push(newItem)
  triggerRef(state) // âœ… æ‰‹åŠ¨è§¦å‘ä¾èµ–æ›´æ–°
  ```

ğŸ¯ æ‰€ä»¥ `triggerRef` æ˜¯ä¸ºäº†å¼¥è¡¥ `shallowRef` çš„â€œæ‡’æƒ°æ€§â€è€Œå­˜åœ¨çš„è¡¥ä¸æœºåˆ¶ã€‚

---

### ğŸ”¹ 3. ä¸ºä»€ä¹ˆä¸éœ€è¦ `triggerReactive`ï¼Ÿ

å› ä¸º `reactive` çš„è®¾è®¡ç†å¿µå®Œå…¨ä¸åŒï¼š

```js
const state = reactive({
  obj: { depth: '1-2' }
})

// ç›´æ¥ä¿®æ”¹å°±èƒ½è§¦å‘æ›´æ–°
state.obj.depth += '!'
```

âœ… åŸå› ï¼š
- `reactive()` è¿”å›çš„æ˜¯ä¸€ä¸ª `Proxy`
- æ‰€æœ‰åµŒå¥—å¯¹è±¡ä¹Ÿä¼šé€’å½’å˜æˆ `Proxy`
- æ‰€ä»¥ä»»ä½•å±æ€§è®¿é—®å’Œä¿®æ”¹éƒ½ä¼šè¢« `get` / `set` æ•è·
- ä¿®æ”¹å³è‡ªåŠ¨è§¦å‘ä¾èµ–æ”¶é›†å’Œæ›´æ–°

ğŸ‘‰ å®ƒæ˜¯**å…¨è‡ªåŠ¨ã€æ— æ„Ÿçš„å“åº”å¼ç³»ç»Ÿ**ï¼Œæ ¹æœ¬ä¸éœ€è¦ä½ æ‰‹åŠ¨â€œå‘Šè¯‰ Vue æˆ‘æ”¹äº†â€ã€‚

---

### ğŸ” ç±»æ¯”ç†è§£

| ç±»å‹ | å°±åƒâ€¦ | æ˜¯å¦éœ€è¦â€œæé†’æ›´æ–°â€ |
|------|------|------------------|
| `ref`ï¼ˆæ™®é€šï¼‰ | è‡ªåŠ¨æ„Ÿåº”å™¨ç¯ï¼ˆæœ‰äººå°±äº®ï¼‰ | âŒ ä¸éœ€è¦ |
| `shallowRef` | æ‰‹åŠ¨å¼€å…³ç¯ + è®¡æ—¶å™¨æé†’ | âœ… éœ€è¦ `triggerRef` |
| `reactive` | å…¨å±‹æ™ºèƒ½ç¯å…‰ç³»ç»Ÿï¼ˆèµ°è·¯å°±äº®ï¼‰ | âŒ ä¸éœ€è¦ |

> `triggerRef` æ˜¯ç»™é‚£äº›â€œä¸æƒ³è‡ªåŠ¨æ„Ÿåº”ä½†åˆæƒ³å¶å°”äº®ä¸€ä¸‹â€çš„ç‰¹æ®Šåœºæ™¯ç”¨çš„ã€‚

---

### ğŸ› ï¸ å¦‚æœçœŸæƒ³â€œæ‰‹åŠ¨è§¦å‘ reactive æ›´æ–°â€æ€ä¹ˆåŠï¼Ÿ

è™½ç„¶æ²¡æœ‰ `triggerReactive`ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼**é—´æ¥å®ç°ç±»ä¼¼æ•ˆæœ**ï¼š

#### âœ… æ–¹æ³•ä¸€ï¼šæ›¿æ¢æ ¹å±æ€§ï¼ˆæ¨èï¼‰

```js
const state = reactive({ data: { ... } })

// æ”¹å˜å¼•ç”¨å³å¯è§¦å‘æ›´æ–°
state.data = { ...state.data, changed: true }
```

Vue èƒ½ç›‘å¬åˆ° `.data` è¢«æ›¿æ¢äº†ã€‚

#### âœ… æ–¹æ³•äºŒï¼šåŒ…è£…ä¸€å±‚ `ref`ï¼Œç”¨äºå¼ºåˆ¶åˆ·æ–°

```js
const forceUpdate = ref(0)
// æ¨¡æ¿ä¸­ç»‘å®š :key="forceUpdate"
// æˆ–åœ¨é€»è¾‘ä¸­ forceUpdate.value++
```

#### âœ… æ–¹æ³•ä¸‰ï¼šç»“åˆ `shallowRef` + `reactive`ï¼ˆç²¾ç»†æ§åˆ¶ï¼‰

```js
const state = shallowRef(
  reactive({
    a: 1,
    b: { c: 2 }
  })
)

// ä¿®æ”¹å†…éƒ¨ä¸ä¼šç«‹åˆ»è§¦å‘ç»„ä»¶æ›´æ–°ï¼ˆå› ä¸º shallowRef ä¸è¿½è¸ªæ·±å±‚ï¼‰
// ä½†ä½ å¯ä»¥ï¼š
state.value.b.c = 3
triggerRef(state) // âœ… ä¸»åŠ¨é€šçŸ¥è§†å›¾æ›´æ–°
```

è¿™æ­£æ˜¯ `shallowRef + triggerRef` çš„é«˜çº§ç”¨æ³•ï¼šæ€§èƒ½ä¼˜åŒ– + æ‰‹åŠ¨æ§åˆ¶æ›´æ–°æ—¶æœºã€‚

---

## ğŸ“š Vue è®¾è®¡å“²å­¦æ€»ç»“

| API | è®¾è®¡ç›®æ ‡ |
|-----|---------|
| `reactive` | â€œä¸€åˆ‡è‡ªåŠ¨å“åº”â€ â†’ å¼€ç®±å³ç”¨ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ |
| `ref` | æ›´çµæ´»ï¼Œç»Ÿä¸€å¤„ç†åŸºæœ¬ç±»å‹å’Œå¯¹è±¡ |
| `shallowXxx` | æ€§èƒ½ä¼˜åŒ–å·¥å…·ï¼ˆé¿å…æ·±åº¦ä»£ç†å¼€é”€ï¼‰ |
| `triggerRef` | ç»™ `shallowRef` æä¾›â€œæ‰‹åŠ¨æ‰³æœºâ€ |

> âš ï¸ æ²¡æœ‰ `triggerReactive` æ˜¯æ•…æ„çš„ â€”â€” å› ä¸º `reactive` çš„è®¾è®¡å°±æ˜¯â€œä½ ä¸ç”¨ç®¡ï¼Œæˆ‘ä¼šè‡ªå·±æ„ŸçŸ¥â€ã€‚

---

## âœ… æœ€ä½³å®è·µå»ºè®®

| ä½¿ç”¨åœºæ™¯ | æ¨èæ–¹æ¡ˆ |
|--------|----------|
| ä¸€èˆ¬ç»„ä»¶çŠ¶æ€ç®¡ç† | `ref` / `reactive`ï¼ˆä¼˜å…ˆï¼‰ |
| å¤§å‹æ•°æ®ç»“æ„ï¼ˆå¦‚ä¸‡çº§èŠ‚ç‚¹æ ‘ï¼‰ | `shallowRef + reactiveå†…éƒ¨)` + `triggerRef` æ§åˆ¶æ›´æ–°èŠ‚å¥ |
| æ‰¹é‡ä¿®æ”¹åç»Ÿä¸€åˆ·æ–° | `shallowRef + triggerRef` |
| æƒ³æ‰‹åŠ¨æ§åˆ¶æ›´æ–°æ—¶æœº | `shallowRef + triggerRef` |

---

## âœ… ç»“è®º

> âŒ æ²¡æœ‰ `triggerReactive` æ˜¯åˆç†çš„ï¼Œä¹Ÿæ˜¯æœ‰æ„ä¸ºä¹‹çš„è®¾è®¡å†³ç­–ã€‚

- `reactive` æ˜¯å…¨è‡ªåŠ¨å“åº”å¼çš„ï¼Œæ— éœ€æ‰‹åŠ¨è§¦å‘ã€‚
- `triggerRef` å­˜åœ¨æ˜¯ä¸ºäº†å¢å¼º `shallowRef` çš„çµæ´»æ€§ï¼Œå¡«è¡¥å…¶â€œä¸è¿½è¸ªæ·±å±‚å˜åŒ–â€çš„ç©ºç™½ã€‚
- å¦‚æœä½ éœ€è¦â€œæ‰‹åŠ¨è§¦å‘æ›´æ–°â€çš„èƒ½åŠ›ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨ `shallowRef` è€Œä¸æ˜¯ `reactive`ã€‚

---

ğŸ§  **ä¸€å¥è¯æ€»ç»“ï¼š**

> Vue çš„å“åº”å¼ç³»ç»Ÿä¸­ï¼Œ`triggerRef` æ˜¯â€œæ‰‹åŠ¨æŒ¡â€çš„æ²¹é—¨ï¼Œè€Œ `reactive` æ˜¯â€œè‡ªåŠ¨æŒ¡â€â€”â€”ä½ ä¸éœ€è¦è¸©ç¦»åˆï¼Œå®ƒè‡ªå·±ä¼šæ¢æŒ¡ã€‚

å¦‚æœä½ æƒ³è¦â€œè¸©ç¦»åˆâ€çš„æ§åˆ¶åŠ›ï¼Œé‚£å°±ç”¨ `shallowRef + triggerRef` å§ ğŸ˜„